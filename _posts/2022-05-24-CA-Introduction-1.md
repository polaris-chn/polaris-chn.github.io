---
layout: post
title: 计算机体系结构基础-1
categories: CA
description: 计算机体系结构的基础知识
keywords: CA
---

# 计算机体系结构基础-1

为了系统性学习计算机体系结构知识，在这里对其基础内容进行一个总结。

## 一些基本概念
### 并行性
#### 指令级并行
是20世纪最后20年体系结构提升性能的主要途径，主要分为两种。一是时间并行，即指令流水线。二是空间并行，即多发射，或者叫超标量。多发射就像是多车道的马路，而乱序执行（Out-of-Order Execution）就是允许在多车道上超车，超标量和乱序执行常常一起使用来提高效率。2010年后进一步挖掘指令级并行的空间已经不大了。

超标量/多发射是具有多个功能部件，是硬件基础；而乱序执行是可以在多个功能部件中自由执行指令，是一种技术手段，二者是不同的概念，并且结合起来才能提升效率。

#### 数据级并行
主要是指单指令多数据流（SIMD）的向量结构。SIMD作为指令级并行的有效补充，早期主要是用于专用处理器上，现在已经成为通用处理器的标配。

#### 任务级并行
大量存在于网络应用中，其代表是多核处理器以及多线程处理器，是目前计算机体系结构提升性能的主要方法。任务级并行的粒度较大，一个线程中可包含几百条甚至更多的指令。

上述三种并行方式在现在处理器中都有，多核处理器运行线程级或进程级并行的程序，每个核采用多发射流水线结构，而且往往有SIMD向量部件。

### 虚拟化
虚拟化的主要目的是为用户提供一个友好的使用界面，因为计算机硬件是复杂的，不好用的，虚拟化则为这个不好用的平台提供了一个好用的界面。虚拟化技术包括虚拟存储，虚拟机，流水线和多发射技术，cache技术，以及分布式共享存储系统中的cache一致性协议。

#### 虚拟存储
操作系统提供虚拟空间，使得程序员可以不用直接和物理内存和外存打交道。操作系统自动完成虚拟地址到物理地址的转换以及数据在内存和外存之间的调入调出。虚拟存储虚拟了内存，具体可见操作系统的课程。

#### 虚拟机
多线程技术，尤其是同时多线程（simultaneous multi-threading, SMT）技术，通过微结构的硬件支持，例如设立多组通用寄存器等，使得在同一个CPU中实现两个或多个线程中的指令在流水线中混合执行，或在同一个CPU中实现线程的快速切换，是用户可以“同时”在一个CPU上执行多个线程。虚拟机技术则通过微结构的硬件增强，如设立多组控制寄存器和系统状态等，实现多个操作系统的快速切换，达到在同一个计算机上“同时”运行多个操作系统的目的。

#### 流水线和多发射结构
工艺的发展使得流水线和多发射结构得以实现，在维持串行编程模式的情况下提高了速度。

#### cache技术
使得CPU可以用到看上去和cache一样快，和内存一样大的存储空间，不用改应用程序就可以提升性能。但现代处理器往往80%以上的晶体管都用在了cache上，代价较大。


#### cache一致性协议
可以在分布式存储的情况下给程序员提供一个统一的编程空间，屏蔽了存储器物理分布的细节。但cache一致性协议没有解决程序员需要并行编程、原有的串行程序不能并行运行的问题。



## 参考
《计算机体系结构基础》 第三版 胡伟武等著